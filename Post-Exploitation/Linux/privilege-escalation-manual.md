Linux privilege escalation - manual
=======

__Attention: The articles published on this wiki are for education purpose, to use during a CTF or for an authorized penetrationtest. By using the wiki, you've agreed to use this knowledge in an ethical way and do not evil in any perspective.__


Kernel and distribution Information
---------
**Kernel and distribution release details**

```bash
cat /etc/*-release
```
```bash
cat /proc/version
```
```bash
uname -a
```

Run on your attacker machine
```bash
searchsploit "Linux Kernel"
```

System Information
---------

**Hostname**
```bash
hostname
```

**Networking details**
```bash
ip a
```

```bash
ifconfig
```

**Current IP address**
```bash
hostname -I | awk '{print $1}'
```

```bash
ip a
```

**Default route details**
```bash
route -n
```

```bash
netstat -rn
```

**DNS server information**
```bash
cat /etc/resolv.conf
```


User Information
---------

**Current user details**
```bash
whoami
```

**Last logged on users**
```bash
last
```

```bash
last | tail
```

**Shows users logged onto the host**
```bash
who
```

```bash
w
```

**List all users including uid/gid information**

**List users with console**
```bash
cat /etc/passwd | grep "sh$"
```

**List all users with a home directory**
```bash
awk -F: '/\/home/ {printf "%s:%s\n",$1,$3}' /etc/passwd
```

**List all users with sudoer rights**
```bash
grep -Po '^sudo.+:\K.*$' /etc/group
```

```bash
grep '^sudo:.*$' /etc/group | cut -d: -f4
```

```bash
getent group sudo | cut -d: -f4
```

**List root accounts**
```bash
awk -F: '($3 == "0") {print}' /etc/passwd
```

**Current user PGP keys**
```bash
gpg --list-keys 2>/dev/null
```


**Extracts password policies and hash storage method information**

**Checks umask value**

**Checks if password hashes are stored in /etc/passwd**
To check that no password hashes are stored in "/etc/passwd", run the following command:
```bash
awk -F: '($2 != "x") {print}' /etc/passwd
```
or
```bash
grep -v '^[^:]*:[x]' /etc/passwd
```

If it produces any output, then a password hash is stored in "/etc/passwd". 

**Extract full details for 'default' uid's such as 0, 1000, 1001 etc**

**Attempt to read restricted files i.e. /etc/shadow**
```bash
cat /etc/shadow
```

**List current users history files (i.e .bash_history, .nano_history, .mysql_history , etc.)**

**Basic SSH checks**

Privileged access
---------
**Which users have recently used sudo**

**Determine if /etc/sudoers is accessible**

**Determine if the current user has Sudo access without a password**
```bash
sudo -l
```

**Is root's home directory accessible**
```bash
ls /root
```

**Are known 'good' breakout binaries available via Sudo (i.e. nmap, vim etc.)**
```bash
sudo -l
```

**List permissions for /home/**
```bash
ls /home -ahlR
```

Environmental
---------

**Display current $PATH**
```bash
echo $PATH
```

**Displays env information**
```bash
env
```